var Le=Object.defineProperty;var qe=(e,t,n)=>t in e?Le(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var d=(e,t,n)=>(qe(e,typeof t!="symbol"?t+"":t,n),n);function he(){return Number((Math.random()+"").slice(2)).toString(32)}function F(...e){console.warn(...e)}function h(e){return e.length}function ie(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function Ve(e){return e.toString().slice(0,5)==="class"}function T(e){return["object","array"].includes(ie(e))}function Be(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function ce(e,t){if(T(e)&&T(t)){const n=Object.keys(e),r=Object.keys(t);if(h(n)!==h(r))return!1;for(const o of n)if(!r.includes(o)||!ce(e[o],t[o]))return!1;return!0}else return e===t}function ue(){return typeof window=="object"}function w(e){return ie(e)==="object"}function Q(e){return Array.isArray(e)}function _(e){return typeof e=="string"}function m(e){return typeof e=="function"}function I(e){Promise.resolve().then(e)}function S(e,t={}){const n=w(e)?new WeakMap:new Map,r=["null","regexp","date","weakset","weakmap"],o=Object.assign({function(c){const u=function(...f){return c.apply(this,f)};return u.prototype=s(c.prototype),u},set(c){const u=new Set;for(const f of c)u.add(s(f));return u},map(c){const u=new Map;for(const[f,a]of c.entries())u.set(f,s(a));return u}},t);function s(c){const u=ie(c);if(!["object","function"].includes(typeof c)||r.includes(u))return c;if(n.has(e))return n.get(e);if(o[u])return o[u](c);const f=Q(c)?[]:{};Object.setPrototypeOf(f,Object.getPrototypeOf(c)),n.set(e,f);for(const a in c)f[a]=s(c[a]);return f}const i=s(e);return n.delete(e),i}function L(e,t){return Object.assign({},e,t)}function p(e,t,n){let r=0;for(;r<e.length;){if(e.hasOwnProperty(r)){const o=e[r];t.apply(n,[o,r,n])}r++}}let N=null;const q=new WeakMap;function X(e){N=e,e(),N=null}function Ue(e){const t=q.get(e)||[],n=t.some(r=>N===r);N&&!n&&(t.push(N),q.set(e,t))}function me(e){const t=q.get(e);t&&p(t,(n,r)=>{n()===!0&&(t.splice(r,1),q.set(e,t))})}const Ke=new WeakMap,ee=new WeakMap,V={RAW:Symbol("__v_raw"),IS_READONLY:Symbol("__v_isReadonly")};function Z(e){if(!T(e)||Object.isFrozen(e))return F(`lue cannot be made reactive: ${e}`),e;if(Ke.get(e))return e;let t=null;return new Proxy(e,{get(n,r,o){if(r===V.RAW)return n;const s=Reflect.get(n,r,o);return Ue(n),T(s)?Z(s):s},set(n,r,o,s){if(n[V.IS_READONLY]||Reflect.get(n,r,s)===o)return!0;const c=Reflect.set(n,r,o,s),u=ee.get(n)||new Set;u.add(r);const f=u.size;return ee.set(n,u),I(()=>{c&&f===1&&me(n),ee.delete(n)}),c},deleteProperty(n,r){const o=Reflect.get(n,r),s=Be(n,r),i=Reflect.deleteProperty(n,r);return t=r,I(()=>{s&&i&&o!==void 0&&r===t&&(me(n),t=null)}),i}})}function ze(e){return w(e)&&!!e[V.RAW]}function fe(e){return ze(e)?e[V.RAW]:e}function He(e){const t={value:e},n=Z(t);function r(){return n.value}function o(s){n.value=s}return[r,o,t]}const Ee="__v_isRef";var pt;class Ye{constructor(t){d(this,pt,!0);d(this,"__v_isShallow",!1);d(this,"_rawValue");d(this,"_value");d(this,"getSignal");d(this,"setSignal");const[n,r,o]=He(t);this._rawValue=o,this.getSignal=n,this.setSignal=r,this._value=n()}get value(){return this.getSignal()}set value(t){this.setSignal(t)}}pt=Ee;function Ge(e=void 0){return new Ye(e)}class Je{constructor(t){d(this,"fn");this.fn=t}}var dt;class ye{constructor(t,n){d(this,"__v_isReadonly",!0);d(this,dt,!0);d(this,"_cacheable",!0);d(this,"_dirty",!0);d(this,"computed");d(this,"_setter");this.computed=new Je(t),this._setter=n}get value(){return this.computed.fn()}set value(t){this._setter?this._setter(t):F("Write operation failed: computed value is readonly")}}dt=Ee;function mt(e){return m(e)?new ye(e):new ye(e.get,e.set)}function Qe(e,t,n={}){let r=!1;if(r)return;const o=e();n.immediate&&t(o,void 0);let s=S(o),i=!0;return X(()=>{if(r)return!0;const c=e();if(T(c)){n.deep&&!ce(c,s)&&(t(c,s),s=S(c));return}if(i){i=!1;return}c!==s&&(t(c,s),s=c)}),()=>{r=!0}}function j(e){return["string","number"].includes(typeof e)&&e!==""}function Me(e){return!/^on/.test(e)}function _e(e){return w(e)&&(_(e.tag)||O(e.tag))}function b(e){return m(e)&&!O(e)}function je(e){return Ve(e)&&e.prototype&&e.prototype.render}function Oe(e){return[void 0,null,"",!0,!1].includes(e)}function Ne(...e){return e.filter(n=>j(n)).join(" ").trim().replace(/\s+/," ")}function v(e){return document.createTextNode(e)}function C(e,t){e.appendChild(t)}function y(e,t,...n){const r={tag:e,attrs:t||{},children:n};return b(r.tag)&&h(r.children)===0&&r.attrs.children&&(r.children=r.attrs.children),r}function M({children:e}){return e}const B=Symbol("Fragment");M.prototype[B]=B;function O(e){return m(e)&&e.prototype&&e.prototype[B]===B}const U=new WeakMap;function Pe(e,t=[]){return p(e,n=>{w(n)&&(b(n.tag)?(t.push({comp:n.tag,props:L(n.attrs,{children:e})}),p(n.children,r=>{b(r)&&t.push({comp:r,props:{}})})):j(n.tag)&&Pe(n.children,t))}),t}function ae(e,t=[]){const n=U.get(e)||[];return t.push(...n),p(n,r=>{const o=ae(r.comp);t.push(...o)}),t}let K=null;function Xe(e){K=e}let ne=null;function yt(e){ne=e}function Ze(e,t){K=e,"ref"in t&&(t.ref.value=ne),ne=null}let le=!1;function ge(e){le=e}const z=new WeakMap;function gt(e){if(le)return;const t=z.get(K)||[];t.some(r=>r===e)||(t.push(e),z.set(K,t))}function we(e){const t=ae(e).map(r=>r.comp);t.unshift(e);const n=[];p(t,r=>{const o=z.get(r)||[];n.push(...o),z.delete(r)}),p(n,r=>r())}const be=new WeakMap;function Re(e){const t=ae(e).map(r=>r.comp);t.unshift(e);const n=[];p(t,r=>{const o=be.get(r)||[];n.push(...o),be.delete(r)}),p(n,r=>r())}function E(e,t,n){if(_(e))return Te(e,t,n);if(m(e)){if(e=e,O(e))return pe(n);if(je(e))return E(e.prototype.render,t,n);Xe(e);const r=L(t,{children:n}),o=e(r);return Ze(e,t),j(o)?v(o):(U.set(e,Pe([o,...o.children])),E(o.tag,o.attrs,o.children))}}function Te(e,t={},n=[""]){if(m(e)&&O(e))return E(e,t,n);const r=document.createElement(e);p(n,o=>{if(m(o)){const s=pe([o]);C(r,s)}else $e(r,o)});for(const o in t)ve(r,o,t[o]);if(t.style&&w(t.style))for(const o in t.style){const s=t.style[o];m(s)?X(()=>r.style[o]=s()):r.style[o]=s}return r}function ve(e,t,n){if(t==="ref"&&w(n)){n.value=e;return}if(t==="created"&&m(n)){n(e);return}let r=o=>e[t]=o;t==="className"?r=o=>e[t]=Ne(...[o].flat()):t.startsWith("data-")&&(r=o=>e.dataset[t.slice(5)]=o),Me(t)&&m(n)?X(()=>r(n())):r(n)}function pe(e){const t=document.createDocumentFragment();return p(e,n=>{m(n)?tt(t,n):$e(t,n)}),t}function $e(e,t){if(!Oe(t)){if(j(t)){const n=v(t);n.nodeValue=t,C(e,n);return}if(Q(t)){const n=pe(t);C(e,n);return}if(_e(t)){const n=Te(t.tag,t.attrs,t.children);C(e,n);return}if(w(t)&&b(t.tag)){const n=E(t.tag,t.attrs,t.children);C(e,n);return}F(`render: 不支持 ${t} 值渲染`)}}function Se(e){if(j(e))return v(e);if(_e(e)||w(e)&&b(e.tag))return E(e.tag,e.attrs,e.children)}function et(e,t){let n=0,r=h(e)-1;for(;n<=r;){const o=Math.ceil((n+r)/2),s=e[o];if(t===s.key)return o;t<s.key?r=o-1:t>s.key&&(n=o+1)}return-1}function tt(e,t){let n=[],r=!0,o=null;const s=v("");C(e,s),X(()=>{let i=t();if(i&&w(i)&&O(i.tag)){F("不支持响应式节点片段渲染");return}Q(i)||(i=[i]),i=i.filter(u=>!Oe(u));let c=0;for(;c<h(i);){let u=i[c];const f=et(n,c);if(f>=0){if(ce(u,n[f].tree)){c++;continue}const a=Se(u);if(!a){i.splice(f,1),c++;continue}const k=n[f].tree;if(b(k.tag)&&we(k.tag),n[f].node.parentElement.replaceChild(a,n[f].node),b(k.tag)){const W=k.tag;Re(W),U.delete(W)}n[f].tree=u,n[f].node=a}else{const a=Se(u);if(!a){c++;continue}if(r)C(e,a);else if(h(n)===0)o??(o=s.parentElement),o.insertBefore(a,s.nextSibling);else{const k=n[h(n)-1].node,W=k.nextSibling;k.parentElement.insertBefore(a,W)}n.push({key:c,tree:u,node:a})}c++}if(h(n)>h(i)){for(let u=h(i);u<h(n);u++){const f=n[u].tree;if(b(f.tag)&&we(f.tag),n[u].node.remove(),b(f.tag)){const a=f.tag;Re(a),U.delete(a)}}n.splice(h(i),h(n)-h(i))}r=!1})}function H(e,t={},n=[""]){if(O(e)){const s=L(t,{children:n}),i=e(s);return Y(i)}if(b(e)){if(e=e,je(e))return H(e.prototype.render,{},[]);const s=L(t,{children:n}),i=e(s);return H(i.tag,i.attrs,i.children)}let r="";for(const s in t){if(s.startsWith("on")||s==="ref")continue;let i=m(t[s])&&Me(s)?t[s]():t[s];if(_(e)&&["innerHTML","innerText"].includes(s)){n=[i];continue}if(s==="className"){i&&(r+=` class="${Ne(...[i].flat())}"`);continue}if(s==="style"&&w(i)){for(const c in i)m(i[c])&&(i[c]=i[c]());i='"'+JSON.stringify(i).slice(1,-1).replace(/"/g,"").replace(/,/g,";")+'"'}r+=` ${s}="${i}"`}const o=Y(n);return`<${e}${r}>${o}</${e}>`}function Y(e){let t="";return p(e,n=>{if(j(n)){t+=n.toString();return}if(Q(n)){t+=Y(n);return}if(m(n)){const r=n();t+=Y([r]);return}if(w(n)){t+=H(n.tag,n.attrs,n.children);return}F(`renderToString: 不支持 ${n} 值渲染`)}),t}const ke=[];function nt(){p(ke,e=>e()),ke.length=0}const re=[];let Fe=!1;function wt(e){if(!le){if(Fe){I(e);return}re.push(e)}}function rt(){p(re,e=>e()),re.length=0,Fe=!0}function ot({tag:e,attrs:t,children:n}){const r=E(e,t,n);return nt(),I(rt),r}function st({tag:e,attrs:t,children:n}){ge(!0);const r=H(e,t,n);return ge(!1),r}function bt(e,t){return ot(y(e,t))}function it(e){const t={};return e.replace(/([^?&=]+)=([^&]+)/g,(n,r,o)=>t[r]=o),t}function G(e){const t=new URL("http://0.0.0.0"+e);return{fullPath:t.href.replace(t.origin,""),path:t.pathname,query:it(t.search),hash:t.hash,meta:{}}}function ct(e){let t="";for(const r in e.query)e.query[r]&&(t+=`${r}=${e.query[r]}&`);t=t?"?"+t.slice(0,-1):"";let n=e.hash?"#"+e.hash:"";return e.path+t+n}function D(e){return e.replace(/\/{1,}/g,"/")}function We(e,t){_(e)&&(g.mode==="history"&&(e=g.base+e),e=G(e));for(const r in e)l[r]=e[r];const{fullPath:n}=l;ue()&&(g.mode==="history"?history[t==="push"?"pushState":"replaceState"]({},"",n):location.hash=n)}function Ae(e){We(e,"push")}function de(e){We(e,"replace")}function te(e){history.go(e)}function ut(){return{back:()=>te(-1),forward:()=>te(1),go:te,push:Ae,replace:de,options:g,currentRoute:fe(l)}}function ft(){return l}const g={base:"",mode:"history",ssrDataKey:"g_initialProps"};let l=null;function at(e){l=e}function xe(){const{origin:e,href:t,hash:n}=location;return g.mode==="hash"?n.replace("#",""):t.replace(e+g.base,"")}let $=null;function Rt(e={}){if(Object.assign(g,e),ue()){const t=G(xe());l=Z(t),window.addEventListener("popstate",()=>{const n=G(xe());for(const r in n)l[r]=n[r]})}return{...ut(),beforeEach(t){$=t}}}const J={currentTemplate:"",ssrData:{}};function St(e){}function De(e,t){t=t.replace(g.base,"");const n=e.find(u=>{const{path:f,exact:a}=u.attrs;return a===!1?(t+"/").startsWith(D(f+"/")):D(f)===t});if(!n)return;const{path:r,component:o,beforeEnter:s,meta:i,redirect:c}=n.attrs;return{path:D(r),component:o,meta:i,beforeEnter:s,redirect:c}}let x;const Ce=[];function lt(e){const t=Ge();let n={};function r(s){const i=De(e.children,s);if(!i){n={},t.value=e.notFound;return}async function c(){if(i.component.prototype||(i.component=(await i.component()).default),t.value===i.component)return;n.path=i.path;const f=se(i.component);if(f){const a=window[g.ssrDataKey];a&&n.path in a?(n.data=a[n.path],delete a[n.path]):n.data=await f(S(n))}t.value=i.component,n.meta=i.meta,l.meta=i.meta}if(i.redirect&&i.redirect!==l.fullPath){de(i.redirect),r(l.path);return}function u(f){f(fe(l),x,()=>{x=S(l),s===l.path?c():r(l.path)})}if($){u($);return}if(i.beforeEnter){u(i.beforeEnter);return}x=S(l),c()}const o=Qe(()=>l.path,s=>{if(x){const i=x.path.split("/"),c=s.split("/");i[1]!==c[1]&&p(Ce,u=>u())}r(s)},{immediate:!0});return e.prefix&&Ce.push(o),y(M,null,()=>y(t.value,{...n}))}const P=Z([]);function oe(e){const t=P.indexOf(e);P.splice(t,1)}let R=null;function Ie(e){function t(c){let u=De(e.children,c);if(u.redirect&&u.redirect!==l.fullPath)return at(G(u.redirect)),t(l.path);function f(a){return R=`b_${he()}`,P.push(R),a(fe(l),x,()=>{x=S(l),u.path!==l.path?Ie(e):(A(R,u.component,{path:u.path,meta:u.meta}),oe(R))}),R}return $?f($):u.beforeEnter?f(u.beforeEnter):u}let n=t(l.path);if(_(n))return y(M,null,n);if(!n){const c=e.notFound;return y(c||M,null)}n=n;let r=n.component;l.meta=n.meta;const o={path:n.path,meta:n.meta};R&&(A(R,r,o),oe(R));const s=`r_${he()}`;if(!r.prototype)return P.push(s),r().then(async c=>{r=c.default;const u=se(r);u&&(o.data=await u(S(o)),J.ssrData[o.path]=o.data),A(s,r,o)}),y(M,null,s);const i=se(r);return i?(P.push(s),i(S(o)).then(c=>{o.data=c,J.ssrData[o.path]=c,A(s,r,o)}),y(M,null,s)):y(r,{...o})}function kt(e){return p(e.children,t=>{e.prefix&&(t.attrs.path=D(e.prefix+t.attrs.path)),t.children=[t.attrs.component]}),ue()?y(lt,{...e}):y(Ie,{...e})}function A(e,t,n){const r=st(y(t,{...n}));oe(e);const o=J.currentTemplate.replace(e,r);J.currentTemplate=o}function se(e){const{getInitialProps:t}=e.prototype;if(t&&m(t))return t}function xt(e){const{to:t,type:n,className:r,children:o,...s}=e,i=ft();_(t)||(e.to=ct(Object.assign({},i,t)));const c=g.mode==="hash"?`${g.base}#${e.to}`:g.base+e.to;function u(f){f.preventDefault(),n==="replace"?de(e.to):Ae(e.to)}return y("a",{className:()=>{const f=e.to+"/",a=i.path+"/";return[a.startsWith(f)&&"active",a===f&&"exact-active",r]},href:c,onclick:u,...s},o)}export{M as F,xt as L,kt as R,ot as a,St as b,mt as c,wt as d,S as e,bt as f,He as g,y as h,Rt as i,yt as j,I as n,gt as o,Ge as r,ft as u,Qe as w};
