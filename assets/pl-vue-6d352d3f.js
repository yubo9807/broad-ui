var Qt=Object.defineProperty;var Xt=(t,r,e)=>r in t?Qt(t,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[r]=e;var p=(t,r,e)=>(Xt(t,typeof r!="symbol"?r+"":r,e),e),kt=(t,r,e)=>{if(!r.has(t))throw TypeError("Cannot "+e)};var ut=(t,r,e)=>(kt(t,r,"read from private field"),e?e.call(t):r.get(t)),O=(t,r,e)=>{if(r.has(t))throw TypeError("Cannot add the same private member more than once");r instanceof WeakSet?r.add(t):r.set(t,e)};var P=(t,r,e)=>(kt(t,r,"access private method"),e);function Nt(){return Number((Math.random()+"").slice(2)).toString(32)}function q(...t){console.warn(...t)}function d(t){return t.length}function bt(t){return Object.prototype.toString.call(t).slice(8,-1).toLowerCase()}function Zt(t){return t.toString().slice(0,5)==="class"}function x(t){return["object","array"].includes(bt(t))}function vt(t,r){return Object.prototype.hasOwnProperty.call(t,r)}function wt(t,r){if(x(t)&&x(r)){const e=Object.keys(t),n=Object.keys(r);if(d(e)!==d(n))return!1;for(const s of e)if(!n.includes(s)||!wt(t[s],r[s]))return!1;return!0}else return t===r}function it(){return typeof window=="object"}function C(t){return bt(t)==="object"}function J(t){return Array.isArray(t)}function E(t){return typeof t=="string"}function y(t){return typeof t=="function"}function Q(t){Promise.resolve().then(t)}class N extends WeakMap{}function R(t,r={}){const e=new N,n=["null","regexp","date","weakset","weakmap"],s=Object.assign({function(o){const c=function(...u){return o.apply(this,u)};return c.prototype=i(o.prototype),c},set(o){const c=new Set;for(const u of o)c.add(i(u));return c},map(o){const c=new Map;for(const[u,a]of o.entries())c.set(u,i(a));return c}},r);function i(o){if(it()&&o instanceof HTMLElement)return o.cloneNode(!0);const c=bt(o);if(!["object","function"].includes(typeof o)||n.includes(c))return o;if(e.has(o))return e.get(o);if(s[c])return s[c](o);const u=J(o)?[]:{};Object.setPrototypeOf(u,Object.getPrototypeOf(o)),e.set(o,u);for(const a in o)o.hasOwnProperty(a)&&(u[a]=i(o[a]));return u}return i(t)}function X(t,r){return Object.assign({},t,r)}function h(t,r,e){let n=0;for(;n<t.length;){if(t.hasOwnProperty(n)){const s=t[n];r.apply(e,[s,n,e])}n++}}let _=null;const H=new N;function z(t){_=t,t(),_=null}function te(t){const r=H.get(t)||[],e=r.some(n=>_===n);_&&!e&&(r.push(_),H.set(t,r))}function Mt(t){const r=H.get(t);r&&h(r,(e,n)=>{e()===!0&&(r.splice(n,1),H.set(t,r))})}function xe(...t){function r(e){const n=ct(e);for(const s in n){const i=n[s];x(i)&&r(i)}H.delete(n)}h(t,r)}const ee=new N,at=new N,Z={RAW:Symbol("__v_raw"),IS_READONLY:Symbol("__v_isReadonly")};function U(t){if(!x(t)||Object.isFrozen(t))return q(`lue cannot be made reactive: ${t}`),t;if(ee.get(t))return t;let r=null;return new Proxy(t,{get(e,n,s){if(n===Z.RAW)return e;const i=Reflect.get(e,n,s);return te(e),x(i)?U(i):i},set(e,n,s,i){if(e[Z.IS_READONLY]||Reflect.get(e,n,i)===s)return!0;const c=Reflect.set(e,n,s,i),u=at.get(e)||new Set;u.add(n);const a=u.size;return at.set(e,u),Q(()=>{c&&a===1&&Mt(e),at.delete(e)}),c},deleteProperty(e,n){const s=Reflect.get(e,n),i=vt(e,n),o=Reflect.deleteProperty(e,n);return r=n,Q(()=>{i&&o&&s!==void 0&&n===r&&(Mt(e),r=null)}),o}})}function ne(t){return C(t)&&!!t[Z.RAW]}function ct(t){return ne(t)?t[Z.RAW]:t}function re(t){const r={value:t},e=U(r);function n(){return e.value}function s(i){e.value=i}return[n,s,r]}const $t=Symbol("__v_isRef");var Ne;class se{constructor(r){p(this,Ne,!0);p(this,"_rawValue");p(this,"_value");p(this,"getSignal");p(this,"setSignal");const[e,n,s]=re(r);this._rawValue=s,this.getSignal=e,this.setSignal=n,this._value=e()}get value(){return this.getSignal()}set value(r){this.setSignal(r)}}Ne=$t;function oe(t=void 0){return new se(t)}class ie{constructor(r){p(this,"fn");this.fn=r}}var Me;class Tt{constructor(r,e){p(this,"__v_isReadonly",!0);p(this,Me,!0);p(this,"_cacheable",!0);p(this,"_dirty",!0);p(this,"computed");p(this,"_setter");this.computed=new ie(r),this._setter=e}get value(){return this.computed.fn()}set value(r){this._setter?this._setter(r):q("Write operation failed: computed value is readonly")}}Me=$t;function Ee(t){return y(t)?new Tt(t):new Tt(t.get,t.set)}function ce(t,r,e={}){let n=!1;if(n)return;const s=t();e.immediate&&r(s,void 0);let i=R(s),o=!0;return z(()=>{if(n)return!0;const c=t();if(x(c)){e.deep&&!wt(c,i)&&(r(c,i),i=R(c));return}if(o){o=!1;return}c!==i&&(r(c,i),i=c)}),()=>{n=!0}}function F(t){return["string","number"].includes(typeof t)&&t!==""}function At(t){return!/^on/.test(t)}function ue(t){return C(t)&&E(t.tag)}function S(t){return y(t)&&!$(t)}function Dt(t){return Zt(t)&&t.prototype&&t.prototype.render}function xt(t){return[void 0,null,"",!0,!1].includes(t)}function qt(...t){return t.filter(e=>F(e)).join(" ").trim().replace(/\s+/," ")}function ft(t){return document.createTextNode(t)}function L(t,r){t.appendChild(r)}function g(t,r,...e){const n={tag:t,attrs:r||{},children:e};return S(n.tag)&&d(n.children)===0&&n.attrs.children&&(n.children=n.attrs.children),n}function j({children:t}){return t}const v=Symbol("Fragment");j.prototype[v]=v;function $(t){return y(t)&&t.prototype&&t.prototype[v]===v}const Y=new N;function Ht(t,r=[]){return h(t,e=>{C(e)&&(S(e.tag)?(r.push({comp:e.tag,props:X(e.attrs,{children:t})}),h(e.children,n=>{S(n)&&r.push({comp:n,props:{}})})):F(e.tag)&&Ht(e.children,r))}),r}function St(t,r=[]){const e=Y.get(t)||[];return r.push(...e),h(e,n=>{const s=St(n.comp);r.push(...s)}),r}let tt=null;function ae(t){tt=t}let ht=null;function je(t){ht=t}function fe(t,r){tt=t,"ref"in r&&(r.ref.value=ht),ht=null}let Rt=!1;function Et(t){Rt=t}const jt=[];function le(){h(jt,t=>t()),jt.length=0}const dt=[];let It=!1;function Fe(t){if(!Rt){if(It){Q(t);return}dt.push(t)}}function pe(){h(dt,t=>t()),dt.length=0,It=!0}const et=new N;function Oe(t){if(Rt)return;const r=et.get(tt)||[];r.some(n=>n===t)||(r.push(t),et.set(tt,r))}function Ft(t){const r=St(t).map(n=>n.comp);r.unshift(t);const e=[];h(r,n=>{const s=et.get(n)||[];e.push(...s),et.delete(n)}),h(e,n=>n())}const Ot=new N;function Pt(t){const r=St(t).map(n=>n.comp);r.unshift(t);const e=[];h(r,n=>{const s=Ot.get(n)||[];e.push(...s),Ot.delete(n)}),h(e,n=>n())}class he{constructor(r){p(this,"config");this.config=r}intercept(r){return r}renderToString(r){Et(!0);const e=this.createHTML(r);return Et(!1),e}createHTML(r){const{tag:e,attrs:n,children:s}=this.intercept(r);if($(e)){const c=X(n,{children:s}),u=e(c);return this.createHTMLFragment(u)}if(S(e)){if(Dt(e)){const a=new e({...n,children:s});return this.createHTML(a.render.bind(a))}const c=X(n,{children:s}),u=e(c);return this.createHTML(u)}let i="";for(const c in n){if(c.startsWith("on")||c==="ref")continue;let u=y(n[c])&&At(c)?n[c]():n[c];if(E(e)&&["innerHTML","innerText"].includes(c)){r.children=[u];continue}if(c==="className"){u&&(i+=` class="${qt(...[u].flat())}"`);continue}if(c==="style"&&C(u)){for(const a in u)y(u[a])&&(u[a]=u[a]());u='"'+JSON.stringify(u).slice(1,-1).replace(/"/g,"").replace(/,/g,";")+'"'}i+=` ${c}="${u}"`}const o=this.createHTMLFragment(s);return`<${e}${i}>${o}</${e}>`}createHTMLFragment(r){let e="";return h(r,n=>{if(F(n)){e+=n.toString();return}if(J(n)){e+=this.createHTMLFragment(n);return}if(y(n)){const s=n();e+=this.createHTMLFragment([s]);return}if(C(n)){e+=this.createHTML(n);return}q(`renderToString: 不支持 ${n} 值渲染`)}),e}}var W,mt,st,Bt,ot,Ut;class Wt extends he{constructor(e){super(e);O(this,W);O(this,st);O(this,ot)}render(e){const n=this.createElement(e);return le(),Q(pe),n}createElement(e){const{tag:n,attrs:s,children:i}=this.intercept(e);if(E(n))return this.createRealNode(n,s,i);if($(n))return this.createNodeFragment(i);if(S(n))return this.createComponent(n,s,i)}createComponent(e,n,s){if(ae(e),Dt(e)){const c=new e({...n,children:s});e=c.render.bind(c)}const i=X(n,{children:s}),o=e(i);return fe(e,n),F(o)?ft(o):(Y.set(e,Ht([o,...o.children])),this.createElement(o))}createRealNode(e,n={},s=[""]){const i=document.createElement(e);h(s,o=>{if(this.intercept(o),y(o)){const c=this.createNodeFragment([o]);L(i,c)}else P(this,W,mt).call(this,i,o)});for(const o in n)P(this,st,Bt).call(this,i,o,n[o]);if(n.style&&C(n.style))for(const o in n.style){const c=n.style[o];y(c)?z(()=>i.style[o]=c()):i.style[o]=c}return i}createNodeFragment(e){const n=document.createDocumentFragment();return h(e,s=>{this.intercept(s),y(s)?P(this,ot,Ut).call(this,n,s):P(this,W,mt).call(this,n,s)}),n}createNode(e){if(F(e))return ft(e);if(ue(e))return this.createRealNode(e.tag,e.attrs,e.children);if($(e.tag))return this.createNodeFragment(e.children);if(S(e.tag))return this.createComponent(e.tag,e.attrs,e.children)}}W=new WeakSet,mt=function(e,n){if(!xt(n)){if(J(n)){const s=this.createNodeFragment(n);L(e,s);return}if(F(n)||C(n)){const s=this.createNode(n);L(e,s);return}q(`render: 不支持 ${n} 值渲染`)}},st=new WeakSet,Bt=function(e,n,s){if(n==="ref"&&C(s)){s.value=e;return}if(n==="created"&&y(s)){s(e);return}let i=o=>e[n]=o;n==="className"?i=o=>e[n]=qt(...[o].flat()):n.startsWith("data-")&&(i=o=>e.dataset[n.slice(5)]=o),At(n)&&y(s)?z(()=>i(s())):i(s)},ot=new WeakSet,Ut=function(e,n){let s=[],i=!0,o=null;const c=ft("");L(e,c),z(()=>{let u=n();if(u&&C(u)&&$(u.tag)){q("不支持响应式节点片段渲染");return}J(u)||(u=[u]),u=u.filter(f=>!xt(f));let a=0;for(;a<d(u);){let f=u[a];const m=de(s,a);if(m>=0){if(wt(f,s[m].tree)){a++;continue}const b=this.createNode(f);if(!b){u.splice(m,1),a++;continue}const M=s[m].tree;if(S(M.tag)&&Ft(M.tag),s[m].node.parentElement.replaceChild(b,s[m].node),S(M.tag)){const V=M.tag;Pt(V),Y.delete(V)}s[m].tree=f,s[m].node=b}else{const b=this.createNode(f);if(!b){a++;continue}if(i)L(e,b);else if(d(s)===0)o??(o=c.parentElement),o.insertBefore(b,c.nextSibling);else{const M=s[d(s)-1].node,V=M.nextSibling;M.parentElement.insertBefore(b,V)}s.push({key:a,tree:f,node:b})}a++}if(d(s)>d(u)){for(let f=d(u);f<d(s);f++){const m=s[f].tree;if(S(m.tag)&&Ft(m.tag),s[f].node.remove(),S(m.tag)){const b=m.tag;Pt(b),Y.delete(b)}}s.splice(d(u),d(s)-d(u))}i=!1})};function de(t,r){let e=0,n=d(t)-1;for(;e<=n;){const s=Math.ceil((e+n)/2),i=t[s];if(r===i.key)return s;r<i.key?n=s-1:r>i.key&&(e=s+1)}return-1}var B;class me extends Wt{constructor(e){super(e);p(this,"version",{}.version);O(this,B,new Map);this.config=e}use(e){return e.install(this),this}intercept(e){if(e&&E(e.tag)){const n=ut(this,B).get(e.tag);n&&(e.tag=n)}return e}component(e,n){return ut(this,B).set(e,n),this}}B=new WeakMap;function Pe(t={}){return new me(t)}function ge(t){return new Wt().render(t)}function Le(t,r){return ge(g(t,r))}function ye(t){const r={};return t.replace(/([^?&=]+)=([^&]+)/g,(e,n,s)=>r[n]=s),r}function A(t){const r=new URL("http://0.0.0.0"+t);return{fullPath:r.href.replace(r.origin,""),path:r.pathname,query:ye(r.search),hash:r.hash,meta:{}}}function be(t){let r="";for(const n in t.query)t.query[n]&&(r+=`${n}=${t.query[n]}&`);r=r?"?"+r.slice(0,-1):"";let e=t.hash?"#"+t.hash:"";return t.path+r+e}function G(t){return t.replace(/\/{1,}/g,"/")}function Vt(t,r){E(t)&&(w.mode==="history"&&(t=w.base+t),t=A(t));for(const n in t)l[n]=t[n];const{fullPath:e}=l;it()&&(w.mode==="history"?history[r==="push"?"pushState":"replaceState"]({},"",e):location.hash=e)}function Kt(t){Vt(t,"push")}function Ct(t){Vt(t,"replace")}function lt(t){history.go(t)}function we(){return{back:()=>lt(-1),forward:()=>lt(1),go:lt,push:Kt,replace:Ct,options:w,currentRoute:ct(l)}}function zt(){return l}const w={base:"",mode:"history",ssrDataKey:"g_initialProps"};let Yt=null,l=null;function Se(t){l=t}function Lt(){const{origin:t,href:r,hash:e}=location;return w.mode==="hash"?e.replace("#",""):r.replace(t+w.base,"")}let I=null;function _e(t={}){if(Object.assign(w,t),it()){const e=A(Lt());l=U(e),window.addEventListener("popstate",()=>{const n=A(Lt());for(const s in n)l[s]=n[s]})}else l=A("");const r=we();return{install(e){Yt=e,e.$router=r,e.$route=zt()},...r,beforeEach(e){I=e}}}const nt={currentTemplate:"",ssrData:{}};function $e(t){}function Gt(t,r){r=r.replace(w.base,"");const e=t.find(u=>{const{path:a,exact:f}=u.attrs;return f===!1?(r+"/").startsWith(G(a+"/")):G(a)===r});if(!e)return;const{path:n,component:s,beforeEnter:i,meta:o,redirect:c}=e.attrs;return{path:G(n),component:s,meta:o,beforeEnter:i,redirect:c}}let T;const _t=[];function Re(t){const r=oe();let e={};function n(i){const o=Gt(t.children,i);if(!o){e={},r.value=t.notFound;return}async function c(){if(o.component.prototype||(o.component=(await o.component()).default),r.value===o.component)return;e.path=o.path;const a=yt(o.component);if(a){const f=window[w.ssrDataKey];f&&e.path in f?(e.data=f[e.path],delete f[e.path]):e.data=await a(R(e))}r.value=o.component,e.meta=o.meta,l.meta=o.meta}if(o.redirect&&o.redirect!==l.fullPath){Ct(o.redirect),n(l.path);return}function u(a){a(ct(l),T,()=>{T=R(l),i===l.path?c():n(l.path)})}if(I){u(I);return}if(o.beforeEnter){u(o.beforeEnter);return}T=R(l),c()}const s=ce(()=>l.path,i=>{if(T){const o=T.path.split("/"),c=i.split("/");o[1]!==c[1]&&h(_t,u=>u())}n(i)},{immediate:!0});return t.prefix&&_t.push(s),g(j,null,()=>g(r.value,{...e}))}const D=U([]);function gt(t){const r=D.indexOf(t);D.splice(r,1)}let k=null;function Jt(t){function r(c){let u=Gt(t.children,c);if(u.redirect&&u.redirect!==l.fullPath)return Se(A(u.redirect)),r(l.path);function a(f){return k=`b_${Nt()}`,D.push(k),f(ct(l),T,()=>{T=R(l),u.path!==l.path?Jt(t):(K(k,u.component,{path:u.path,meta:u.meta}),gt(k))}),k}return I?a(I):u.beforeEnter?a(u.beforeEnter):u}let e=r(l.path);if(E(e))return g(j,null,e);if(!e){const c=t.notFound;return g(c||j,null)}e=e;let n=e.component;l.meta=e.meta;const s={path:e.path,meta:e.meta};k&&(K(k,n,s),gt(k));const i=`r_${Nt()}`;if(!n.prototype)return D.push(i),n().then(async c=>{n=c.default;const u=yt(n);u&&(s.data=await u(R(s)),nt.ssrData[s.path]=s.data),K(i,n,s)}),g(j,null,i);const o=yt(n);return o?(D.push(i),o(R(s)).then(c=>{s.data=c,nt.ssrData[s.path]=c,K(i,n,s)}),g(j,null,i)):g(n,{...s})}function Ae(t){return h(t.children,r=>{t.prefix&&(r.attrs.path=G(t.prefix+r.attrs.path)),r.children=[r.attrs.component]}),it()?g(Re,{...t}):g(Jt,{...t})}function K(t,r,e){const n=Yt.renderToString(g(r,{...e}));gt(t);const s=nt.currentTemplate.replace(t,n);nt.currentTemplate=s}function yt(t){const{getInitialProps:r}=t.prototype;if(r&&y(r))return r}function De(t){const{to:r,type:e,className:n,children:s,...i}=t,o=zt();E(r)||(t.to=be(Object.assign({},o,r)));const c=w.mode==="hash"?`${w.base}#${t.to}`:w.base+t.to;function u(a){a.preventDefault(),e==="replace"?Ct(t.to):Kt(t.to)}return g("a",{className:()=>{const a=t.to+"/",f=o.path+"/";return[f.startsWith(a)&&"active",f===a&&"exact-active",n]},href:c,onclick:u,...i},s)}const rt=Symbol("action");function Ce(t){return y(t)&&t.prototype[rt]===rt}class ke{constructor(r,e){p(this,"state");p(this,"actions");this.state=U(R(r)),this.actions={};for(const n in e){let i=function(...o){const c=e[n].bind(r)(...o);if(x(c)&&c[Symbol.toStringTag]==="Promise")c.then(u=>(s._merge(r),u));else return s._merge(r),c};const s=this;i.prototype[rt]=rt,s.actions[n]=i}Object.assign(this.state,this.actions);for(const n in this.actions)Object.defineProperty(this.state,n,{writable:!1})}_merge(r){const e=R(r),n=Object.keys(e);for(const s in e)this.state[s]=e[s];for(const s in this.state)Ce(this.state[s])||!n.includes(s)&&delete this.state[s]}}const pt=new N;function qe(t){const{id:r,state:e,actions:n}=t;return()=>{if(!pt.has(e)){const s=new ke(e,n);pt.set(e,s.state)}return pt.get(e)}}export{j as F,De as L,Ae as R,ge as a,xe as b,Ee as c,qe as d,Oe as e,$e as f,R as g,g as h,it as i,Pe as j,_e as k,U as l,Le as m,Q as n,Fe as o,re as p,je as q,oe as r,zt as u,ce as w};
