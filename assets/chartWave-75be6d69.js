var z=Object.defineProperty;var x=(a,t,i)=>t in a?z(a,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[t]=i;var l=(a,t,i)=>(x(a,typeof t!="symbol"?t+"":t,i),i),m=(a,t,i)=>{if(!t.has(a))throw TypeError("Cannot "+i)};var p=(a,t,i)=>(m(a,t,"read from private field"),i?i.call(a):t.get(a)),g=(a,t,i)=>{if(t.has(a))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(a):t.set(a,i)},d=(a,t,i,e)=>(m(a,t,"write to private field"),e?e.call(a,i):t.set(a,i),i);function T(a){const t=a/2;return t/Math.floor(t)===1||t===0}var v,_,r;class A{constructor(t){l(this,"_canvas");l(this,"_ctx");l(this,"option");g(this,v,0);g(this,_,0);g(this,r,0);l(this,"_animationId",null);var i;this.option=Object.assign({percentage:0,radian:1,color:"#0080ff",noTransition:!1,speed:1},t),(i=this.option).size??(i.size=t.el.clientWidth),this.option.size=Array.isArray(this.option.size)?this.option.size:[this.option.size,this.option.size],this._canvas=document.createElement("canvas"),this._canvas.width=this.option.size[0],this._canvas.height=this.option.size[1],t.el.appendChild(this._canvas),this._ctx=this._canvas.getContext("2d"),d(this,r,this._canvas.width/2),this.animation()}_drawWave(t){const i=this._ctx,e=p(this,r),s=p(this,_),n=p(this,v);function u(o){const c=e*(o+1)+t;return o===0?i.moveTo(e*o+t,s):i.lineTo(e*o+t,s),i.quadraticCurveTo(e*(o+1)-e/2+t,s+n,c,s),c}function f(o){const c=e*(o+1)+t;return o===0?i.moveTo(e*o+t,s):i.lineTo(e*o+t,s),i.quadraticCurveTo(e*(o+1)-e/2+t,s*2-(s+n),c,s),c}let h=0;return function(c){for(;h<=c;){const w=T(h)?u(h):f(h);if(h===c)return w;h++}}}_graph(t=0,i="#00f"){this._ctx.beginPath();const e=this._drawWave(t),s=this._canvas.width/p(this,r)*2,n=e(s);this._ctx.lineTo(n,p(this,_)),this._ctx.lineTo(n,this._canvas.height),this._ctx.lineTo(t,this._canvas.height),this._ctx.closePath(),this._ctx.fillStyle=i,this._ctx.fill()}animation(){let t=-this._canvas.width,i=-this._canvas.width,e=-this._canvas.width,s=0;const n=this;u();function u(){s>n.option.percentage&&s--,s<n.option.percentage&&s++,d(n,_,n._canvas.height-n._canvas.height*(s/100));const f=s<60?s/2:(100-s)/2+10;d(n,v,f*n.option.radian),t>0&&(t=-n._canvas.width),i>0&&(i=-n._canvas.width),e>0&&(e=-n._canvas.width),n._ctx.clearRect(0,0,n._canvas.width,n._canvas.height);const h=n.option.color;n._graph(t,h+"33"),n._graph(i,h+"55"),n._graph(e,h),t+=4*n.option.speed,i+=3*n.option.speed,e+=2*n.option.speed,n._animationId=requestAnimationFrame(u)}}refresh(){var n;if((n=this.option).size??(n.size=this.option.el.clientWidth),this.option.size=Array.isArray(this.option.size)?this.option.size:[this.option.size,this.option.size],this._canvas.width=this.option.size[0],this._canvas.height=this.option.size[1],d(this,r,this._canvas.width/2),this.option.noTransition)return;let t=0,i=null;const e=this;(function(){cancelAnimationFrame(e._animationId),t=e.option.percentage,e.option.percentage=0,s(),e.animation()})();function s(){if(e.option.percentage>=t){cancelAnimationFrame(i);return}e.option.percentage++,i=requestAnimationFrame(s)}}}v=new WeakMap,_=new WeakMap,r=new WeakMap;export{A as C};
