var Ie=Object.defineProperty;var Le=(e,t,n)=>t in e?Ie(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var p=(e,t,n)=>(Le(e,typeof t!="symbol"?t+"":t,n),n);function le(){return Number((Math.random()+"").slice(2)).toString(32)}function F(...e){console.warn(...e)}function d(e){return e.length}function oe(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function qe(e){return e.toString().slice(0,5)==="class"}function T(e){return["object","array"].includes(oe(e))}function Ve(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function ie(e,t){if(T(e)&&T(t)){const n=Object.keys(e),r=Object.keys(t);if(d(n)!==d(r))return!1;for(const o of n)if(!r.includes(o)||!ie(e[o],t[o]))return!1;return!0}else return e===t}function se(){return typeof window=="object"}function w(e){return oe(e)==="object"}function G(e){return Array.isArray(e)}function M(e){return typeof e=="string"}function h(e){return typeof e=="function"}function I(e){Promise.resolve().then(e)}function S(e,t={}){const n=new WeakMap,r=["null","regexp","date","weakset","weakmap"],o=Object.assign({function(i){const c=function(...u){return i.apply(this,u)};return c.prototype=s(i.prototype),c},set(i){const c=new Set;for(const u of i)c.add(s(u));return c},map(i){const c=new Map;for(const[u,f]of i.entries())c.set(u,s(f));return c}},t);function s(i){const c=oe(i);if(!["object","function"].includes(typeof i)||r.includes(c))return i;if(n.has(i))return n.get(i);if(o[c])return o[c](i);const u=G(i)?[]:{};Object.setPrototypeOf(u,Object.getPrototypeOf(i)),n.set(i,u);for(const f in i)u[f]=s(i[f]);return u}return s(e)}function L(e,t){return Object.assign({},e,t)}function m(e,t,n){let r=0;for(;r<e.length;){if(e.hasOwnProperty(r)){const o=e[r];t.apply(n,[o,r,n])}r++}}let N=null;const q=new WeakMap;function J(e){N=e,e(),N=null}function Be(e){const t=q.get(e)||[],n=t.some(r=>N===r);N&&!n&&(t.push(N),q.set(e,t))}function pe(e){const t=q.get(e);t&&m(t,(n,r)=>{n()===!0&&(t.splice(r,1),q.set(e,t))})}const Ue=new WeakMap,Z=new WeakMap,V={RAW:Symbol("__v_raw"),IS_READONLY:Symbol("__v_isReadonly")};function Q(e){if(!T(e)||Object.isFrozen(e))return F(`lue cannot be made reactive: ${e}`),e;if(Ue.get(e))return e;let t=null;return new Proxy(e,{get(n,r,o){if(r===V.RAW)return n;const s=Reflect.get(n,r,o);return Be(n),T(s)?Q(s):s},set(n,r,o,s){if(n[V.IS_READONLY]||Reflect.get(n,r,s)===o)return!0;const c=Reflect.set(n,r,o,s),u=Z.get(n)||new Set;u.add(r);const f=u.size;return Z.set(n,u),I(()=>{c&&f===1&&pe(n),Z.delete(n)}),c},deleteProperty(n,r){const o=Reflect.get(n,r),s=Ve(n,r),i=Reflect.deleteProperty(n,r);return t=r,I(()=>{s&&i&&o!==void 0&&r===t&&(pe(n),t=null)}),i}})}function Ke(e){return w(e)&&!!e[V.RAW]}function ce(e){return Ke(e)?e[V.RAW]:e}function ze(e){const t={value:e},n=Q(t);function r(){return n.value}function o(s){n.value=s}return[r,o,t]}const _e="__v_isRef";var at;class He{constructor(t){p(this,at,!0);p(this,"__v_isShallow",!1);p(this,"_rawValue");p(this,"_value");p(this,"getSignal");p(this,"setSignal");const[n,r,o]=ze(t);this._rawValue=o,this.getSignal=n,this.setSignal=r,this._value=n()}get value(){return this.getSignal()}set value(t){this.setSignal(t)}}at=_e;function Ye(e=void 0){return new He(e)}class Ge{constructor(t){p(this,"fn");this.fn=t}}var lt;class de{constructor(t,n){p(this,"__v_isReadonly",!0);p(this,lt,!0);p(this,"_cacheable",!0);p(this,"_dirty",!0);p(this,"computed");p(this,"_setter");this.computed=new Ge(t),this._setter=n}get value(){return this.computed.fn()}set value(t){this._setter?this._setter(t):F("Write operation failed: computed value is readonly")}}lt=_e;function dt(e){return h(e)?new de(e):new de(e.get,e.set)}function Je(e,t,n={}){let r=!1;if(r)return;const o=e();n.immediate&&t(o,void 0);let s=S(o),i=!0;return J(()=>{if(r)return!0;const c=e();if(T(c)){n.deep&&!ie(c,s)&&(t(c,s),s=S(c));return}if(i){i=!1;return}c!==s&&(t(c,s),s=c)}),()=>{r=!0}}function O(e){return["string","number"].includes(typeof e)&&e!==""}function xe(e){return!/^on/.test(e)}function Ee(e){return w(e)&&(M(e.tag)||j(e.tag))}function b(e){return h(e)&&!j(e)}function Ce(e){return qe(e)&&e.prototype&&e.prototype.render}function Me(e){return[void 0,null,"",!0,!1].includes(e)}function Oe(...e){return e.filter(n=>O(n)).join(" ").trim().replace(/\s+/," ")}function X(e){return document.createTextNode(e)}function x(e,t){e.appendChild(t)}function y(e,t,...n){const r={tag:e,attrs:t||{},children:n};return b(r.tag)&&d(r.children)===0&&r.attrs.children&&(r.children=r.attrs.children),r}function C({children:e}){return e}const B=Symbol("Fragment");C.prototype[B]=B;function j(e){return h(e)&&e.prototype&&e.prototype[B]===B}const U=new WeakMap;function je(e,t=[]){return m(e,n=>{w(n)&&(b(n.tag)?t.push({comp:n.tag,props:L(n.attrs,{children:e})}):O(n.tag)&&je(n.children,t))}),t}function ue(e,t=[]){const n=U.get(e)||[];return t.push(...n),m(n,r=>{const o=ue(r.comp);t.push(...o)}),t}let ee=null;function ht(e){ee=e}function Qe(e,t){"ref"in t&&(t.ref.value=ee),ee=null}let Ne=!1;function he(e){Ne=e}const me=new WeakMap;function ye(e){const t=ue(e).map(r=>r.comp);t.unshift(e);const n=[];m(t,r=>{const o=me.get(r)||[];n.push(...o),me.delete(r)}),m(n,r=>r())}const ge=new WeakMap;function we(e){const t=ue(e).map(r=>r.comp);t.unshift(e);const n=[];m(t,r=>{const o=ge.get(r)||[];n.push(...o),ge.delete(r)}),m(n,r=>r())}function E(e,t,n){if(M(e))return Pe(e,t,n);if(h(e)){if(e=e,j(e))return fe(n);if(Ce(e))return E(e.prototype.render,t,n);const r=L(t,{children:n}),o=e(r);return Qe(e,t),O(o)?X(o):(U.set(e,je(o.children)),E(o.tag,o.attrs,o.children))}}function Pe(e,t={},n=[""]){if(h(e)&&j(e))return E(e,t,n);const r=document.createElement(e);m(n,o=>{if(h(o)){const s=fe([o]);x(r,s)}else Te(r,o)});for(const o in t)Xe(r,o,t[o]);if(t.style&&w(t.style))for(const o in t.style){const s=t.style[o];h(s)?J(()=>r.style[o]=s()):r.style[o]=s}return r}function Xe(e,t,n){if(t==="ref"&&w(n)){n.value=e;return}if(t==="created"&&h(n)){n(e);return}let r=o=>e[t]=o;t==="className"?r=o=>e[t]=Oe(...[o].flat()):t.startsWith("data-")&&(r=o=>e.dataset[t.slice(5)]=o),xe(t)&&h(n)?J(()=>r(n())):r(n)}function fe(e){const t=document.createDocumentFragment();return m(e,n=>{h(n)?ve(t,n):Te(t,n)}),t}function Te(e,t){if(!Me(t)){if(O(t)){const n=X(t);n.nodeValue=t,x(e,n);return}if(G(t)){const n=fe(t);x(e,n);return}if(Ee(t)){const n=Pe(t.tag,t.attrs,t.children);x(e,n);return}if(w(t)&&b(t.tag)){const n=E(t.tag,t.attrs,t.children);x(e,n);return}F(`render: 不支持 ${t} 值渲染`)}}function be(e){if(O(e))return X(e);if(Ee(e)||w(e)&&b(e.tag))return E(e.tag,e.attrs,e.children)}function Ze(e,t){let n=0,r=d(e)-1;for(;n<=r;){const o=Math.ceil((n+r)/2),s=e[o];if(t===s.key)return o;t<s.key?r=o-1:t>s.key&&(n=o+1)}return-1}function ve(e,t){let n=[],r=!0,o=null;const s=X("");x(e,s),J(()=>{let i=t();if(i&&w(i)&&j(i.tag)){F("不支持响应式节点片段渲染");return}G(i)||(i=[i]),i=i.filter(u=>!Me(u));let c=0;for(;c<d(i);){let u=i[c];const f=Ze(n,c);if(f>=0){if(ie(u,n[f].tree)){c++;continue}const l=be(u);if(!l){i.splice(f,1),c++;continue}const k=n[f].tree;if(b(k.tag)&&ye(k.tag),n[f].node.parentElement.replaceChild(l,n[f].node),b(k.tag)){const W=k.tag;we(W),U.delete(W)}n[f].tree=u,n[f].node=l}else{const l=be(u);if(!l){c++;continue}if(r)x(e,l);else if(d(n)===0)o??(o=s.parentElement),o.insertBefore(l,s.nextSibling);else{const k=n[d(n)-1].node,W=k.nextSibling;k.parentElement.insertBefore(l,W)}n.push({key:c,tree:u,node:l})}c++}if(d(n)>d(i)){for(let u=d(i);u<d(n);u++){const f=n[u].tree;if(b(f.tag)&&ye(f.tag),n[u].node.remove(),b(f.tag)){const l=f.tag;we(l),U.delete(l)}}n.splice(d(i),d(n)-d(i))}r=!1})}function K(e,t={},n=[""]){if(j(e)){const s=L(t,{children:n}),i=e(s);return z(i)}if(b(e)){if(e=e,Ce(e))return K(e.prototype.render,{},[]);const s=L(t,{children:n}),i=e(s);return K(i.tag,i.attrs,i.children)}let r="";for(const s in t){if(s.startsWith("on")||s==="ref")continue;let i=h(t[s])&&xe(s)?t[s]():t[s];if(M(e)&&["innerHTML","innerText"].includes(s)){n=[i];continue}if(s==="className"){i&&(r+=` class="${Oe(...[i].flat())}"`);continue}if(s==="style"&&w(i)){for(const c in i)h(i[c])&&(i[c]=i[c]());i='"'+JSON.stringify(i).slice(1,-1).replace(/"/g,"").replace(/,/g,";")+'"'}r+=` ${s}="${i}"`}const o=z(n);return`<${e}${r}>${o}</${e}>`}function z(e){let t="";return m(e,n=>{if(O(n)){t+=n.toString();return}if(G(n)){t+=z(n);return}if(h(n)){const r=n();t+=z([r]);return}if(w(n)){t+=K(n.tag,n.attrs,n.children);return}F(`renderToString: 不支持 ${n} 值渲染`)}),t}const Re=[];function et(){m(Re,e=>e()),Re.length=0}const te=[];let $e=!1;function mt(e){if(!Ne){if($e){I(e);return}te.push(e)}}function tt(){m(te,e=>e()),te.length=0,$e=!0}function nt({tag:e,attrs:t,children:n}){const r=E(e,t,n);return et(),I(tt),r}function rt({tag:e,attrs:t,children:n}){he(!0);const r=K(e,t,n);return he(!1),r}function yt(e,t){return nt(y(e,t))}function ot(e){const t={};return e.replace(/([^?&=]+)=([^&]+)/g,(n,r,o)=>t[r]=o),t}function H(e){const t=new URL("http://0.0.0.0"+e);return{fullPath:t.href.replace(t.origin,""),path:t.pathname,query:ot(t.search),hash:t.hash,meta:{}}}function it(e){let t="";for(const r in e.query)e.query[r]&&(t+=`${r}=${e.query[r]}&`);t=t?"?"+t.slice(0,-1):"";let n=e.hash?"#"+e.hash:"";return e.path+t+n}function D(e){return e.replace(/\/{1,}/g,"/")}function Fe(e,t){M(e)&&(g.mode==="history"&&(e=g.base+e),e=H(e));for(const r in e)a[r]=e[r];const{fullPath:n}=a;se()&&(g.mode==="history"?history[t==="push"?"pushState":"replaceState"]({},"",n):location.hash=n)}function We(e){Fe(e,"push")}function ae(e){Fe(e,"replace")}function v(e){history.go(e)}function st(){return{back:()=>v(-1),forward:()=>v(1),go:v,push:We,replace:ae,options:g,currentRoute:ce(a)}}function ct(){return a}const g={base:"",mode:"history",ssrDataKey:"g_initialProps"};let a=null;function ut(e){a=e}function Se(){const{origin:e,href:t,hash:n}=location;return g.mode==="hash"?n.replace("#",""):t.replace(e+g.base,"")}let $=null;function gt(e={}){if(Object.assign(g,e),se()){const t=H(Se());a=Q(t),window.addEventListener("popstate",()=>{const n=H(Se());for(const r in n)a[r]=n[r]})}return{...st(),beforeEach(t){$=t}}}const Y={currentTemplate:"",ssrData:{}};function wt(e){}function Ae(e,t){t=t.replace(g.base,"");const n=e.find(u=>{const{path:f,exact:l}=u.attrs;return l===!1?(t+"/").startsWith(D(f+"/")):D(f)===t});if(!n)return;const{path:r,component:o,beforeEnter:s,meta:i,redirect:c}=n.attrs;return{path:D(r),component:o,meta:i,beforeEnter:s,redirect:c}}let _;const ke=[];function ft(e){const t=Ye();let n={};function r(s){const i=Ae(e.children,s);if(!i){n={},t.value=e.notFound;return}async function c(){if(i.component.prototype||(i.component=(await i.component()).default),t.value===i.component)return;n.path=i.path;const f=re(i.component);if(f){const l=window[g.ssrDataKey];l&&n.path in l?(n.data=l[n.path],delete l[n.path]):n.data=await f(S(n))}t.value=i.component,n.meta=i.meta,a.meta=i.meta}if(i.redirect&&i.redirect!==a.fullPath){ae(i.redirect),r(a.path);return}function u(f){f(ce(a),_,()=>{_=S(a),s===a.path?c():r(a.path)})}if($){u($);return}if(i.beforeEnter){u(i.beforeEnter);return}_=S(a),c()}const o=Je(()=>a.path,s=>{if(_){const i=_.path.split("/"),c=s.split("/");i[1]!==c[1]&&m(ke,u=>u())}r(s)},{immediate:!0});return e.prefix&&ke.push(o),y(C,null,()=>y(t.value,{...n}))}const P=Q([]);function ne(e){const t=P.indexOf(e);P.splice(t,1)}let R=null;function De(e){function t(c){let u=Ae(e.children,c);if(u.redirect&&u.redirect!==a.fullPath)return ut(H(u.redirect)),t(a.path);function f(l){return R=`b_${le()}`,P.push(R),l(ce(a),_,()=>{_=S(a),u.path!==a.path?De(e):(A(R,u.component,{path:u.path,meta:u.meta}),ne(R))}),R}return $?f($):u.beforeEnter?f(u.beforeEnter):u}let n=t(a.path);if(M(n))return y(C,null,n);if(!n){const c=e.notFound;return y(c||C,null)}n=n;let r=n.component;a.meta=n.meta;const o={path:n.path,meta:n.meta};R&&(A(R,r,o),ne(R));const s=`r_${le()}`;if(!r.prototype)return P.push(s),r().then(async c=>{r=c.default;const u=re(r);u&&(o.data=await u(S(o)),Y.ssrData[o.path]=o.data),A(s,r,o)}),y(C,null,s);const i=re(r);return i?(P.push(s),i(S(o)).then(c=>{o.data=c,Y.ssrData[o.path]=c,A(s,r,o)}),y(C,null,s)):y(r,{...o})}function bt(e){return e.prefix&&m(e.children,t=>{t.attrs.path=D(e.prefix+t.attrs.path)}),se()?y(ft,{...e}):y(De,{...e})}function A(e,t,n){const r=rt(y(t,{...n}));ne(e);const o=Y.currentTemplate.replace(e,r);Y.currentTemplate=o}function re(e){const{getInitialProps:t}=e.prototype;if(t&&h(t))return t}function Rt(e){M(e.to)||(e.to=it(e.to));const t=g.mode==="hash"?`${g.base}#${e.to}`:g.base+e.to;function n(o){o.preventDefault(),e.type==="replace"?ae(e.to):We(e.to)}const r=ct();return y("a",{className:()=>{const o=e.to+"/",s=r.path+"/";return[s.startsWith(o)&&"active",s===o&&"exact-active",e.className]},href:t,onclick:n},e.children)}export{C as F,Rt as L,bt as R,nt as a,wt as b,dt as c,S as d,ze as e,ht as f,y as h,gt as i,I as n,mt as o,Ye as r,yt as u,Je as w};
